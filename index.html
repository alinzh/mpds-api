<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<title>MPDS: Introduction for Developers and Robots</title>
<link rel="stylesheet" href="style.css" />
<!--[if lt IE 9]>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.1.1/gh-fork-ribbon.ie.min.css" />
<![endif]-->
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript" src="/js/jquery.nearest.min.js"></script>
<script type="text/javascript" src="/js/require.min.js"></script>
<script type="text/javascript">
if (!window.console) window.console = {log: function(){}, error: function(){}};

$.fn.isAfter = function(sel){
  return this.prevAll(sel).length !== 0;
}

function load_schema(addr, el){
    $.get(addr).done(function(schema){
    try {
        docson.doc(el, schema);
    } catch (e) {
        console.error("Could not parse JSON schema!");
    }
    }).fail(function (xhr, status, err) {
        console.error("Could not load JSON schema");
    });
}

function debounce(func, wait, immediate){
    var timeout;
    return function(){
        var context = this,
            args = arguments;
        var later = function(){
            timeout = null;
            if (!immediate) func.apply(context, args);
        }
        var callNow = immediate && !timeout;
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
        if (callNow) func.apply(context, args);
    }
}

function is_inview(element){
    var pageTop = $(window).scrollTop(),
        pageBottom = pageTop + $(window).height(),
        elementTop = $(element).offset().top,
        elementBottom = elementTop + $(element).height();
    return ((elementTop <= pageBottom) && (elementBottom >= pageTop));
}

function update_menu(){
    $('#menu a').removeClass('active');
    var tol = 2, cnt = 0;
    $('#content .view').each(function(){
        if (is_inview(this)){
            var h3 = $(this).nearest('h3').attr('id');
            var h2 = $(this).nearest('h2').attr('id');
            $('#menu a[href="#' + h3 + '"]').addClass('active');
            $('#menu a[href="#' + h2 + '"]').addClass('active');
            cnt++;
            if (cnt == tol) return false;
        }
    });
}

$(document).ready(function(){
    var menu = '<ul>';
    $('h2, h3').each(function(){
        var that = $(this),
            active_cls = '',
            hlevel = that.prop('tagName'),
            value = that.text(),
            href = that.attr('id');
        if (is_inview(that)) active_cls = ' class="active"';

        if (hlevel == 'H2') menu += '<li><a' + active_cls + ' href="#' + href + '">' + value + '</a></li>';
        else if (hlevel == 'H3') menu += '<li><ul><li><a' + active_cls + ' href="#' + href + '">' + value + '</a></li></ul></li>';
    });
    menu += '</ul>';
    $('#menu').append(menu);

    require(['js/docson'], function(docson){
        load_schema('/s.schema.json', 's_json_schema');
        load_schema('/p.schema.json', 'p_json_schema');
    });

    $.ajax({
        url: 'https://gist.github.com/blokhin/f0770a154db6cc38ff2fb594aaa1738e.json',
        dataType: 'jsonp',
        timeout: 1000,
        success: function (data) {
            $(document.head).append('<link href="' + data.stylesheet + '" rel="stylesheet">');
            $('#json_schema_gist').append(data.div);
        }
    });

    $(window).scroll(debounce(update_menu, 250));
});
</script>
</script>
</head>
<body class="sky">
    <div id="nav">
        <a href="https://mpds.io">MPDS Start Page</a>
    </div>

    <div id="menu"></div>

    <div id="main">
        <div id="landing_box">
            <div id="logo_l">MPDS</div><div id="logo"></div><div id="logo_r">Materials Platform<br />for Data Science</div>
            <div id="motto">based on the <a href="http://paulingfile.com" target="_blank">Linus Pauling File</a> materials database</div>
        </div>

        <div class="spacer"></div>

        <div id="content">
            <p class="view" style="background:#eff;">Dear developers! We are happy to welcome you here. This is the draft of documentation, being constantly updated. To use the MPDS API you will need a valid key from your <a href="https://mpds.io/#modal/menu">MPDS account</a>. Please, <a href="mailto:eb@tilde.pro">contact us</a> if you do not have an account.</p>

            <p class="view">The MPDS API described below presents all the scientific data of the Linus Pauling File materials database in the developer-friendly machine-readable formats, <i>e.g.</i> <strong>JSON</strong>, <strong>CIF</strong>, <strong>BIBTEX</strong> <i>etc.</i></p>

            <h2 id="Downloading-data">&sect;1. Downloading data</h2>

            <h3 id="Overview">&sect;1.1. Overview</h3>

            <p class="view">The standard unit of the MPDS data is an <strong>entry</strong>. All the MPDS entries are subdivided into three kinds: <strong>crystalline structures</strong>, <strong>physical properties</strong>, and <strong>phase diagrams</strong>. They are called S-, P- or C-entries, correspondingly. In the current version of the API only the entries of the same kind can be requested. Mixing of different kinds is not supported.</p>

            <p class="view">Another dimension of the MPDS data is the <strong>distinct phases</strong>. The three kinds of entries are interlinked via the distinct phases they belong.</p>

            <h3 id="Categories">&sect;1.2. Categories of data</h3>

            <p class="view">Generally, the most frequent action is to get the data according to some criteria. We support 8 basic criteria for searching and downloading:</p>

            <table class="view">
                <thead>
                    <tr>
                    <th>Criterion</th>
                    <th>Machine-readable name</th>
                    <th>Examples</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                    <td>Physical properties (from <a href="https://mpds.io/#hierarchy">MPDS physical properties hierarchy</a>)</td>
                    <td><span class="t">props</span></td>
                    <td><span class="t">conductivity</span></td>
                    </tr>
                    <tr>
                    <td>Chemical elements</td>
                    <td><span class="t">elements</span></td>
                    <td><span class="t">Cs</span>, <span class="t">Fr, O</span></td>
                    </tr>
                    <tr>
                    <td>Materials classes (various classes under the same name: <i>i.e.</i> minerals, chemical groups, common terms <i>etc.</i>)</td>
                    <td><span class="t">classes</span></td>
                    <td><span class="t">perovskite</span>, <span class="t">bcc</span></td>
                    </tr>
                    <tr>
                    <td>Crystal system</td>
                    <td><span class="t">lattices</span></td>
                    <td><span class="t">orthorhombic</span></td>
                    </tr>
                    <tr>
                    <td>Chemical formula</td>
                    <td><span class="t">formulae</span></td>
                    <td><span class="t">SrTiO3</span>, <span class="t">O3Al2</span></td>
                    </tr>
                    <tr>
                    <td>Space group (number or Hermann-Mauguin notation)</td>
                    <td><span class="t">sgs</span></td>
                    <td><span class="t">Pm3m</span>, <span class="t">221</span></td>
                    </tr>
                    <tr>
                    <td>Prototype system ("Strukturbericht" or MPDS notation: formula, Pearson symbol, space group number)</td>
                    <td><span class="t">protos</span></td>
                    <td><span class="t">D51</span>,<br /><span class="t">SiS2 oI12 72</span></td>
                    </tr>
                    <tr>
                    <td>Publication author</td>
                    <td><span class="t">authors</span></td>
                    <td><span class="t">Evarestov</span></td>
                    </tr>
                </tbody>
            </table>

            <div class="caption"><b>Table 1.</b> Categories of the requested data.</div>

            <h3 id="REST-endpoint">&sect;1.3. REST-alike download endpoint</h3>

            <p class="view">To serve data we employ the <a href="https://en.wikipedia.org/wiki/Representational_state_transfer">REST</a>-alike endpoints, following the <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">HTTP</a> protocol basics. We support input parameters in the query string and headers and provide the standard HTTP status codes in response. The address of the data download endpoint is the following:</p>

            <div class="blackbg">https://api.mpds.io/v0/download/facet</div>

            <p class="view">The HTTP verb to be used is always <span class="t">GET</span>. The header must always contain the <span class="t">Key</span> string with the valid MPDS API key, obtained from your <a href="https://mpds.io/#modal/menu">MPDS account</a>. A minimal <span class="t">curl</span> example looks:</p>

            <div class="blackbg">curl -X GET -H "Key:a_long_and_secret_string" https://api.mpds.io/v0/download/facet</div>

            <p class="view">The following parameters are supported for this endpoint:</p>

            <table class="view">
                <thead>
                    <tr>
                    <th>Parameter</th>
                    <th>Type</th>
                    <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                    <td><span class="t">q</span></td>
                    <td><span class="t">JSON-serialized object</span></td>
                    <td>The object <span class="t">q</span> may contain any reasonable combination of properties, which are given in the Table 1, column "Machine-readable name". An object property <span class="t">props</span> is compulsory (in contrast to others), since it determines the <strong>kind</strong> of the desired data (e.g. <strong>crystalline structures</strong> or <strong>physical properties</strong>).</td>
                    </tr>
                    <tr>
                    <td><span class="t">pagesize</span></td>
                    <td><span class="t">integer</span></td>
                    <td>The number of hits per page (pagination). Default value: <span class="t">10</span>. Allowed values: <span class="t">10</span>, <span class="t">100</span>, <span class="t">500</span>, and <span class="t">1000</span>.</td>
                    </tr>
                    <tr>
                    <td><span class="t">page</span></td>
                    <td><span class="t">integer</span></td>
                    <td>The page number, either in the selected or in the default pagination. Counts from <span class="t">0</span>. Defaults to the first page, which has number <span class="t">0</span>, <i>i.e.</i> the default value is <span class="t">0</span>.</td>
                    </tr>
                    <tr>
                    <td><span class="t">fmt</span></td>
                    <td><span class="t">integer</span></td>
                    <td>Output data format. Can be <span class="t">json</span> or <span class="t">cif</span>. The latter <span class="t">cif</span> is only valid for <strong>crystalline structures</strong>. Default value: <span class="t">json</span>.</td>
                    </tr>
                </tbody>
            </table>

            <div class="caption"><b>Table 2.</b> Query string parameters for the download endpoint.</div>

            <p class="view">An example of the <span class="t">q</span> parameter to request the <strong>crystalline structures</strong> (with the spaces and line breaks added for readability):</p>

            <div class="blackbg view">{
    "elements": "Sr-Ti-O",
    "classes": "perovskite, conductor",
    "sgs": "Pm-3m",
    "props": "structural properties"
}</div>

            <p class="view">Once again, note that you should always include the property <span class="t">props</span>, in order to distinguish the kinds of the entries. Another example of the <span class="t">q</span> parameter to request <strong>physical properties</strong>:</p>

            <div class="blackbg view">{
    "elements": "Zr",
    "classes": "oxide",
    "props": "thermal expansion"
}</div>

            <p class="view">By default the response has <span class="t">json</span> format, containing the following properties: <span class="t">out</span> (list <i>i.e.</i> array of the MPDS entries), <span class="t">npages</span> (number of pages in the selected or default pagination), <span class="t">page</span> (current page number), <span class="t">count</span> (total number of hits), and <span class="t">error</span> (should be <span class="t">null</span>).</p>

            <div class="blackbg view">{
    "error": null,
    "out": [
        {
            "entry_one_properties": "entry_one_values"
        },
        {
            "entry_two_properties": "entry_two_values"
        }
    ],
    "npages": 1,
    "page": 0,
    "count": 2
}</div>

            <p class="view">And if no results are found:</p>

            <div class="blackbg view">{
    "error": null,
    "out": [],
    "npages": 0,
    "count": 0,
    "page": 0
}</div>

            <p class="view">The output in <span class="t">cif</span> format presents nothing more than concatenated <strong>CIF</strong>s in plain text.</p>

            <p class="view">The response for a correctly understood request will always have the status code <span class="t">200</span>, whereas the status codes <span class="t">400</span> ("Wrong parameters") or <span class="t">403</span> ("Forbidden") may signal about an error in the request. Generally, checking the response status code should be always done first.</p>

            <h3 id="JSON-schemata">&sect;1.4. JSON schemata of the MPDS entries</h3>

            <p class="view">JSON is the first-class passenger in the MPDS API. We provide JSON schema for the MPDS entries of <strong>crystalline structures</strong> and <strong>physical properties</strong> in the API output:</p>

            <div id="s_json_schema" class="view"></div>

            <div class="caption"><b>Fig. 1.</b> Interactive JSON schema for the <strong>crystalline structures</strong> or <strong>S-entries</strong><br />(also available as a <a href="https://raw.githubusercontent.com/mpds-io/API/gh-pages/s.schema.json">separate file</a>).</div>

            <div id="p_json_schema" class="view"></div>

            <div class="caption"><b>Fig. 2.</b> Interactive JSON schema for the <strong>physical properties</strong> or <strong>P-entries</strong><br />(also available as a <a href="https://raw.githubusercontent.com/mpds-io/API/gh-pages/p.schema.json">separate file</a>).</div>

            <p class="view">The MPDS API JSON output can be validated against the above schemata <i>e.g.</i> using python script. In the following example the <span class="t">jsonschema</span> python package is used:</p>

            <div id="json_schema_gist" class="view"></div>

            <div class="caption view"><b>Listing 1.</b> A python console script for JSON validation.</div>

            <!-- h2 id="Test-menu">&sect;2. Test menu</h2 -->
            <!-- h3 id="Testing">&sect;2.1. Testing</h3 -->

            <p>Thanks for reading! Please do not hesitate to <a href="mailto:eb@tilde.pro">contact us</a> if you have any feedback or questions.</p>
        </div>
    </div>

    <div id="logo_bg"></div>

    <div id="footer">Created by <a href="http://paulingfile.com" target="_blank">Materials Phase Data System</a> and <a href="https://tilde.pro" target="_blank">Tilde Materials Informatics</a>.</div>

    <div class="github-fork-ribbon-wrapper right">
        <div class="github-fork-ribbon">
            <a href="https://github.com/mpds-io/API" target="_top">See on GitHub</a>
        </div>
    </div>
</body>
</html>
